<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CliniScan: Lung Abnormality Detection</title>
    <style>
        body { font-family: Arial; text-align: center; padding:50px; background:#f9f9f9; }
        #dropArea { border:2px dashed #aaa; border-radius:10px; padding:50px; margin:20px auto; width:400px; background:#fff; cursor:pointer; }
        #dropArea.hover { border-color:#333; }
        #dropArea span { color:blue; text-decoration:underline; }
        #resultImage { max-width:500px; margin-top:20px; display:none; border:2px solid #333; border-radius:10px; }
        #status { font-size:18px; margin-top:15px; }
    </style>
</head>
<body>
    <h1>CliniScan: Lung Abnormality Detection</h1>
    <p>AI-powered medical image analysis for early diagnosis</p>

    <div id="dropArea">
        Drag & Drop Chest X-ray <br> or <span>Click to Browse</span>
    </div>
    <input type="file" id="image" name="image" accept="image/*" style="display:none;">

    <p id="status"></p>
    <img id="resultImage" src="">

    <script>
        const dropArea = document.getElementById("dropArea");
        const imageInput = document.getElementById("image");
        const status = document.getElementById("status");
        const resultImage = document.getElementById("resultImage");

        dropArea.addEventListener("click", () => imageInput.click());

        dropArea.addEventListener("dragover", e => { e.preventDefault(); dropArea.classList.add("hover"); });
        dropArea.addEventListener("dragleave", e => dropArea.classList.remove("hover"));
        dropArea.addEventListener("drop", e => {
            e.preventDefault(); dropArea.classList.remove("hover");
            if(e.dataTransfer.files.length){ imageInput.files = e.dataTransfer.files; startUpload(); }
        });

        imageInput.addEventListener("change", () => { if(imageInput.files.length) startUpload(); });

        function startUpload(){
            const formData = new FormData();
            formData.append("image", imageInput.files[0]);
            status.innerText = "Processing...";
            resultImage.style.display = "none";

            fetch("/upload", { method:"POST", body:formData })
                .then(res => res.json())
                .then(data => {
                    if(data.error){ status.innerText = data.error; return; }
                    resultImage.src = data.output + "?t=" + new Date().getTime();
                    resultImage.style.display = "block";
                    status.innerText = data.abnormal ? "ðŸ”´ Abnormal" : "ðŸŸ¢ Normal";
                })
                .catch(err => { console.error(err); status.innerText="Error processing image"; });
        }
    </script>
</body>
</html>
